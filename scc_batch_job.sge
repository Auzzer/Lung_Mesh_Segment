#!/bin/bash -l
#$ -P batmanlab
#$ -N inverse_alpha_2region
#$ -l h_rt=04:00:00
#$ -pe omp 16
#$ -l gpus=1
#$ -l gpu_c=7.0
#$ -o /projectnb/batmanlab/haozhe/Lung_Mesh_Segment/hetero_verification/logs/$JOB_NAME.$JOB_ID.out
#$ -e /projectnb/batmanlab/haozhe/Lung_Mesh_Segment/hetero_verification/logs/$JOB_NAME.$JOB_ID.err
#$ -j y
#$ -V

set -Eeuo pipefail
trap 'echo "[ERROR] line:$LINENO status:$?"' ERR
set -x

echo "JOB_ID=$JOB_ID HOST=$HOSTNAME NSLOTS=$NSLOTS"
date
nvidia-smi || true

export OMP_NUM_THREADS=${NSLOTS}
export MKL_NUM_THREADS=${NSLOTS}
export OPENBLAS_NUM_THREADS=${NSLOTS}
export NUMEXPR_NUM_THREADS=${NSLOTS}

/projectnb/batmanlab/haozhe/.conda/envs/lung-project/bin/python \
  /projectnb/batmanlab/haozhe/Lung_Mesh_Segment/hetero_verification/inverse_alpha_2region.py
